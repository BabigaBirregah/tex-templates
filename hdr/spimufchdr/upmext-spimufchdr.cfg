% UP-METHODOLOGY EXTENSION FOR THE SPIM-UFC PHD THESIS
% Author: Stephane GALLAND
% Copyright (c) 2013 Stephane GALLAND <galland@arakhne.org>

\makeatletter
\@ifclasslater{upmethodology-document}{2013/08/14}{}{
	\@latex@error{You must install a version of the package 'upmethodology-document.cls'
		greater or equal to 20130815}
}
\makeatother

\DeclareCopyright[french]{spimufchdr}{2013}{Dr. St\'ephane GALLAND}{Les noms des cit\'es, les marques cit\'ees ainsi que les logos correspondants sont la propri\'et\'e de leurs auteurs ou de leurs ayant-droits. Toute reproduction, m\^eme partielle des \'el\'ements de ce document donnera syst\'ematiquement lieu \`a des poursuites judiciaires. L'acronyme SPIM est la propri\'et\'e de l'\'Ecole Doctoale Science Pour l'Ing\'enieur et Micro\'electronique, France. L'acronymes UFC est la propri\'et\'e de l'Universit\'e de Franche-Comt\'e, France.}
\DeclareCopyright[english]{spimufchdr}{2013}{Dr. St\'ephane GALLAND}{SPIM and all SPIM-related trademarks and logos are trademarks or registered trademarks of \'Ecole Doctoale Science Pour l'Ing\'enieur et Micro\'electronique in France, other countries, or both. UFC and all UFC-related trademarks and logos are trademarks or registered trademarks of Universit\'e de Franche-Comt\'e in the France, other countries, or both.}

\usepackage{helvet}
\usepackage{hyphenat}
\renewcommand{\familydefault}{\sfdefault}

\definecolor{frontpagetitle}{rgb}{0,0,0}
\definecolor{frontpageauthors}{rgb}{0,0,0}

\definecolor{backpagetitle}{rgb}{0.698,0.862,0.094}
\definecolor{backpagetext}{rgb}{0,0,0}

\definecolor{backtableheader}{rgb}{0.901,0.901,0.901}
\definecolor{fronttableheader}{rgb}{0.388,0.478,0.051}

\definecolor{sectiontitlecolor}{rgb}{0.388,0.478,0.051}
\definecolor{chaptertitlecolor}{rgb}{0.388,0.478,0.051}
\definecolor{parttitlecolor}{rgb}{0.388,0.478,0.051}

\Set{frontillustration}{spimufchdr-frontpage}
\Set{p3illustration}{spimufchdr-p3-head}
\Set{backillustration}{spimufchdr-backpage}

\Set{watermarksize}{.5}

\Set{universityname}{Universit\'e de Franche-Comt\'e}
\Set{speciality}{Informatique}
\Set{defensedate}{\today}
\Set{jurytabwidth}{\textwidth}

%\declarehdr[subtitle]{title}{defense date}
\newcommand{\declarehdr}[3][] {
	\declaredocument{#2}{#1}{HDR-XXXX}%
	\Set{defensedate}{#3}%
	\initialversion{\makedate{11}{04}{2006}}{HDR}{\upmpublic}%
}

%\addjury[email]{firstname}{lastname}{type}{position}
\makeatletter
\newcommand{\edspim@hdr@protectnl}[1]{%
	\begingroup%
		\let\\\newline%
		\nohyphens{#1}%
	\endgroup%
}
\gdef\edspim@hdr@jurylist{}
\global\let\thejurytab\relax
\newcommand{\addjury}[5][]{%
	\global\protected@edef\edspim@hdr@jurylist{\edspim@hdr@jurylist\protect\protect\upmmakename{#2}{#3}{~} & \protect\edspim@hdr@protectnl{#4} & \protect\edspim@hdr@protectnl{#5} \protect\\}%
	\global\protected@edef\thejurytab{\protect\noindent\protect\begin{tabularx}{\Get{jurytabwidth}}{@{}llX@{}}\edspim@hdr@jurylist\protect\end{tabularx}}%
}

%\hdrpreparedin{university name}
\newif\ifhdrhaspreparedin
\hdrhaspreparedinfalse
\newif\ifhdrhaspreparedinmulti
\hdrhaspreparedinmultifalse
\gdef\thehdrpreparedin{}
\newcommand{\hdrpreparedin}[1]{%
	\ifhdrhaspreparedin%
		\hdrhaspreparedinmultitrue%
		\global\protected@edef\thehdrpreparedin{\thehdrpreparedin,\protect\\\protect{#1}}%
	\else%
		\hdrhaspreparedintrue%
		\global\protected@edef\thehdrpreparedin{\thehdrpreparedin\protect{#1}}%
	\fi%
}

% Change the French labels
\let\edspim@hdr@tableofcontents\tableofcontents
\renewcommand{\tableofcontents}{%
	\ifthenelse{\equal{french}{\upmcurrentlang}}{\renewcommand{\contentsname}{Sommaire}}{}%
	\edspim@hdr@tableofcontents%
}

% Defense message
\Set{defensemessage}{Soutenue publiquement le \Get{defensedate} devant le Jury compos\'e de~:}

% Change the color of the TOC
\let\edspim@hdr@l@contentsline\contentsline
\renewcommand{\contentsline}[4]{%
	%{subsection}{\numberline {1.1.2}Extension de la plateforme \textsc {JaSIM}\xspace et Application}{18}{subsection.1.1.2}
	\ifthenelse
		{\equal{#1}{part}}
		{\edspim@hdr@l@contentsline{#1}{\textcolor{parttitlecolor}{#2}}{\textcolor{parttitlecolor}{#3}}{#4}}%
		{\ifthenelse
			{\equal{#1}{chapter}}
			{\edspim@hdr@l@contentsline{#1}{\textcolor{chaptertitlecolor}{#2}}{\textcolor{chaptertitlecolor}{#3}}{#4}}%
			{\edspim@hdr@l@contentsline{#1}{#2}{#3}{#4}}}%
}

% \hdrabstract [lang]{text}
\newif\ifhdrmainabstract
\hdrmainabstractfalse
\newif\ifhdrminorabstract
\hdrminorabstractfalse
\gdef\hdrmainabstract{}
\gdef\hdrminorabstract{}
\gdef\hdrmainabstracttitle{R\'esum\'e~:}
\gdef\hdrminorabstracttitle{Abstract:}
\newcommand{\hdrabstract}[2][\upmcurrentlang]{%
	\ifthenelse{\equal{\upmcurrentlang}{#1}}{%
		\global\hdrmainabstracttrue%
		\gdef\hdrmainabstract{#2}%
		\setdocabstract{#2}%
		\ifthenelse{\equal{english}{#1}}{%
			\gdef\hdrmainabstracttitle{Abstract:}
		}{%
			\gdef\hdrmainabstracttitle{R\'esum\'e~:}
		}%
	}{%
		\global\hdrminorabstracttrue%
		\gdef\hdrminorabstract{#2}%
		\ifthenelse{\equal{english}{#1}}{%
			\gdef\hdrminorabstracttitle{Abstract:}
		}{%
			\gdef\hdrminorabstracttitle{R\'esum\'e~:}
		}%
	}%
}

% \hdrkeywords [lang]{keywords}
\newif\ifhdrmainkeywords
\hdrmainkeywordsfalse
\newif\ifhdrminorkeywords
\hdrminorkeywordsfalse
\gdef\hdrmainkeywords{}
\gdef\hdrminorkeywords{}
\gdef\hdrmainkeywordstitle{}
\gdef\hdrminorkeywordstitle{}
\newcommand{\hdrkeywords}[2][\upmcurrentlang]{%
	\ifthenelse{\equal{\upmcurrentlang}{#1}}{%
		\global\hdrmainkeywordstrue%
		\gdef\hdrmainkeywords{#2}%
		\ifthenelse{\equal{english}{#1}}{%
			\gdef\hdrmainkeywordstitle{Keywords:}
		}{%
			\gdef\hdrmainkeywordstitle{Mots-cl\'es~:}
		}%
	}{%
		\global\hdrminorkeywordstrue%
		\gdef\hdrminorkeywords{#2}%
		\ifthenelse{\equal{english}{#1}}{%
			\gdef\hdrminorkeywordstitle{Keywords:}
		}{%
			\gdef\hdrminorkeywordstitle{Mots-cl\'es~:}
		}%
	}%
}

\makeatother

\Set{cfrontpage}{
%	\begin{picture}(0,0)
%	\put(-100,-740){\includegraphics[width=600\unitlength,height=855\unitlength]{\Get{frontillustration}}}
%	\put(40,-430){\textcolor{frontpagetitle}{%
%			\parbox[b][8cm][t]{14cm}{\huge%this size permits to control the interline space
%				\mbox{}\vfill\sffamily%
%				\begin{flushleft}%
%				\noindent{\Huge\nohyphens{\theupmproject}}%
%				\Ifnotempty\theupmdocname{\\[.25cm]\large%this size permits to control the interline space
%					\noindent{\Large\nohyphens{\theupmdocname}}}%
%				\end{flushleft}%
%				%\vfill\mbox{}%
%			}}}
%	\put(70,-490){\textcolor{frontpageauthors}{%
%			\parbox[t][5cm][t]{10cm}{\sffamily%
%				\Ifnotempty\theauthorlist{\noindent\huge\theauthorlist}
%				}}}%
%	\end{picture}%
%	\cleardoublepage%
	\pagestyle{empty}%
	\begin{picture}(0,0)
	\put(-100,-165){\includegraphics[width=600\unitlength]{\Get{p3illustration}}}
	\put(-45,-200){\parbox[t][12cm][t]{17cm}{%
		\begin{center}%
			{\Large \textsc{Habilitation \`a diriger des recherches}} \\[.2cm]
			{de l'\Get{universityname}} \\[.2cm]
			\ifhdrhaspreparedin%
				{pr\'epar\'ee au sein de l'\thehdrpreparedin} \\[.2cm]%
			\fi%
			{Sp\'ecialit\'e~:~\textbf{\Get{speciality}}} \\[1cm]%
			{pr\'esent\'ee par} \\[.5cm]
			{\huge\theauthorlist}\\[1cm]%
			\parbox{\linewidth}{\centering\huge\nohyphens{\theupmproject}}%parbox permits to control the interline space
			\Large\Ifnotempty\theupmdocname{\\[.25cm]{\Large\nohyphens{\theupmdocname}}}%
		\end{center}%
	}}
	\put(-45,-730){\parbox[b]{17cm}{%
		\begin{center}%
		\Get{defensemessage}\\[.25cm]%
		\thejurytab%
		\end{center}
	}}
	\end{picture}%
	\cleardoublepage%
}

\Set{backpage}{
	\begin{picture}(0,0)
	\ifupmbookformat%
		\gdef\upmhdrtmpaaa{-72}%
		\gdef\upmhdrtmpbbb{-17}%
	\else%
		\gdef\upmhdrtmpaaa{-100}%
		\gdef\upmhdrtmpbbb{-45}%
	\fi%
	\expandafter\put(\upmhdrtmpaaa,-740){\includegraphics[width=600\unitlength,height=900\unitlength]{\Get{backillustration}}}
	\put(\upmhdrtmpbbb,0){\parbox[t][12cm][t]{17cm}{%
		\ifhdrmainabstract%
			\textcolor{backpagetitle}{\textbf{\large{\hdrmainabstracttitle}}}\\[.5cm]
			\Get{primaryabstractstyle}\nohyphens{\textcolor{backpagetext}{\ignorespaces\hdrmainabstract}}%
			\ifhdrmainkeywords%
				\vspace{.15cm}\par\noindent{\begin{tabularx}{\linewidth}{@{}lX@{}}\textcolor{backpagetitle}{\small\textbf{\hdrmainkeywordstitle}} & %
				\small\textcolor{backpagetext}{\Get{primarykeywordstyle}\ignorespaces\hdrmainkeywords}\end{tabularx}}%
			\fi%
			\ifhdrminorabstract%
				\par\vspace{2cm}%
			\fi%
		\fi%
		\ifhdrminorabstract%
			\textcolor{backpagetitle}{\textbf{\large{\hdrminorabstracttitle}}}\\[.5cm]
			\Get{secondaryabstractstyle}\nohyphens{\textcolor{backpagetext}{\ignorespaces\hdrminorabstract}}%
			\ifhdrminorkeywords%
				\vspace{.15cm}\par\noindent{\begin{tabularx}{\linewidth}{@{}lX@{}}\small\textcolor{backpagetitle}{\textbf{\hdrminorkeywordstitle}} &%
				\small\textcolor{backpagetext}{\Get{secondarykeywordstyle}\ignorespaces\hdrminorkeywords}\end{tabularx}}%
			\fi%
		\fi%
	}}%
	\end{picture}
}

\AtBeginDocument{
	\renewcommand{\headrulewidth}{0pt}
	\renewcommand{\footrulewidth}{0pt}
}

\makeatletter

\if@twoside
%
% TWO SIDE
%
% Left header
\lhead{%
	\fancyplain{}{\upm@header@fmt{\leftmark}}%
}
% Center header
\chead{}
% Right header
\rhead{%
	\fancyplain{}{\upm@header@fmt{\ifthenelse{\thepage>0}{\thepage}{}}}%
}
% Left footer
\lfoot{}
% Center footer
\cfoot{}
% Right footer
\rfoot{}

\else
%
% ONE SIDE
%
% Left header
\lhead{%
	\fancyplain{}{\upm@header@fmt{\leftmark}}%
}
% Center header
\chead{}
% Right header
\rhead{%
	\fancyplain{}{\upm@header@fmt{\ifthenelse{\thepage>0}{\thepage}{}}}%
}
% Left footer
\lfoot{}
% Center footer
\cfoot{}
% Right footer
\rfoot{%
	\upm@header@fmt{\ifthenelse{\thepage>0}{\thepage}{}}%
}

\fi

\makeatother

\endinput
